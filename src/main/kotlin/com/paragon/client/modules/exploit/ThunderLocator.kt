package com.paragon.client.modules.exploit

import com.paragon.Paragon
import com.paragon.backend.event.events.net.PacketEvent
import com.paragon.backend.module.Category
import com.paragon.backend.module.Module
import me.bush.eventbus.annotation.EventListener
import net.minecraft.network.packet.s2c.play.PlaySoundS2CPacket
import net.minecraft.sound.SoundEvent
import net.minecraft.sound.SoundEvents

/**
 * @author aesthetical
 * @since 02/25/23
 */
object ThunderLocator : Module("Thunder Locator", "Locates thunder", Category.EXPLOIT) {

    @EventListener
    fun onPacketInbound(event: PacketEvent.Inbound) {
        if (event.packet is PlaySoundS2CPacket) {
            val packet = event.packet

            val soundEvent = (packet.sound.value() as SoundEvent)
            if (soundEvent == SoundEvents.ENTITY_LIGHTNING_BOLT_THUNDER || soundEvent == SoundEvents.ENTITY_LIGHTNING_BOLT_IMPACT) {
                Paragon.toastManager.info(this.name,
                        "Thunder sounded at ${String.format("%.1f", packet.x)}, ${String.format("%.1f", packet.y)}, ${String.format("%.1f", packet.z)}",
                        5000L)

            }
        }
    }

}